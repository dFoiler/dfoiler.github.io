---
title: "Genus Theory"
date: 2025-11-13
author_profile: false
permalink: /posts/2025/11/genus-theory/
tags:
  - number theory
---

We compute the \\(2\\)-part of the class group of an imaginary quadratic field \\(K\\).

> **Theorem 1.**
Let \\(K\\) be an imaginary quadratic field, and let \\(S\\) be the set of primes of \\(K\\) which are ramified.
- Then \\(\dim_{\mathbb F_2}\operatorname{Pic}(\mathcal O_K)[2]=\left\|S\right\|-1\\).
- The vector space \\(\operatorname{Pic}(\mathcal O_K)[2]\\) is spanned by \\(S\\).

For example, it follows that \\(K\\) having unique prime factorization implies that \\(K\in\\{\mathbb Q(i),\mathbb Q(\sqrt{-2})\\}\\) or \\(K=\mathbb Q(\sqrt{-p})\\) where \\(p\\) is a prime with \\(p\equiv3\pmod4\\).

> **Remark 2.**
Of course, it is also possible to show the previous sentence more directly. Say \\(K=\mathbb Q(\sqrt d)\\) with \\(d<0\\), and let the discriminnt be \\(D\\); we want to show that \\(D\\) has only one prime factor. A principal ramified prime \\(\mathfrak p\\) over \\((p)\\) being principal provides an element with norm \\(p\\), which allows us to solve some quadratic form \\(Q_K\\) equal to \\(p\\). Expanding out \\(Q_K\\) as either \\(x^2-dy^2\\) or \\(x^2+xy+\frac{1-d}4y^2\\) shows that
\\[p\ge\frac14\left\|D\right\|.\\]
Thus, if \\(D\\) has more than one prime factor, then \\(\left\|D\right\|\le16\\), and one can handle these cases by hand.

Our exposition follows [Matthew Emerton](https://www.math.uchicago.edu/~emerton/number-theory/genus.pdf). Many of the arguments we will make will work for more general Galois extensions \\(L/K\\) of number fields. In this situation, genus theory is about understanding \\(\operatorname{Pic}(\mathcal O_L)^G\\), where \\(G\\) is the Galois group. To explain the relation to the \\(2\\)-part of the class group, we note the following.

> **Lemma 3.**
Let \\(L/K\\) be a quadratic extension of number fields with Galois group \\(G\\), and assume that \\(\operatorname{Pic}\mathcal O_K\\) is trivial. Then
\\[\operatorname{Pic}(\mathcal O_L)^{G}=\operatorname{Pic}(\mathcal O_L)[2].\\]

*Proof.*
Let \\(\sigma\in G\\) be the nontrivial element. Then we claim that \\(\sigma[I]=-[I]\\) for any ideal class \\([I]\\). This implies that \\([I]\\) is fixed by \\(\sigma\\) if and only if \\([I]\\) is \\(2\\)-torsion, thereby proving the lemma.

It remains to show the claim. By unique prime factorization, it is enough to show the claim in the case that \\(I\\) is a prime ideal \\(\mathfrak q\\), and we set \\(\mathfrak p=\mathfrak q\cap K\\) be the prime lying under \\(\mathfrak q\\). We now combine two observations.
- On one hand, because \\(K\\) has trivial class group, we see that \\(\mathfrak p\\) is principal.
- On the other hand, we claim that there is an integer \\(r\\) for which
\\[\mathfrak p^r\mathcal O_L\stackrel?=\mathfrak q\cdot\sigma\mathfrak q.\\]
This can be checked depending on the splitting behavior of \\(\mathfrak p\\) and the fact that \\(\operatorname{Gal}(L/K)\\) acts transitively on the primes lying above \\(\mathfrak p\\). Explicitly, if \\(\mathfrak p\\) is split or ramified, then \\(r=1\\); if \\(\mathfrak p\\) is inert, then \\(r=2\\).

Combining the above observations shows that \\(\sigma\mathfrak q\\) is the inverse of \\(\mathfrak q\\) in the class group. \\(\blacksquare\\)

We are now interested in studying \\(\operatorname{Pic}(\mathcal O_L)^{\operatorname{Gal}(L/K)}\\). Unsurprisingly, we will use Galois cohomology. The main point is to compute with the long exact sequence of
\\[0\to\operatorname{PDiv}(\mathcal O_L)\to\operatorname{Div}(\mathcal O_L)\to\operatorname{Pic}(\mathcal O_L)\to0.\\]
Thus, we will be interested in the cohomology of \\(\operatorname{PDiv}(\mathcal O_L)\\) and \\(\operatorname{Div}(\mathcal O_L)\\).

> **Lemma 4.**
Let \\(L/K\\) be a Galois extension of number fields with Galois group \\(G\\).
>    - There is a right exact sequence
>    \\[\operatorname{PDiv}(\mathcal O_K)\to\operatorname{PDiv}(\mathcal O_L)^G\to\mathrm H^1(G;\mathcal O_L^\times)\to0.\\]
>    - There is a left exact sequence
>    \\[0\to\mathrm H^1(G;\operatorname{PDiv}(\mathcal O_L))\to\mathrm H^2(G;\mathcal O_L^\times)\to\mathrm H^2(G;L^\times).\\]

*Proof.*
Both claims follow from taking Galois cohomology of the short exact sequence
\\[1\to\mathcal O_L^\times\to L^\times\to\operatorname{PDiv}(\mathcal O_L)\to0.\\]
The right \\(0\\) and the left \\(0\\) in both claims arises by Hilbert's theorem 90, which tells us \\(\mathrm H^1(G;L^\times)=0\\). Lastly, in the first claim, \\(\operatorname{PDiv}(\mathcal O_K)\\) is simply being used as a stand-in for the image of \\(K^\times\\) in \\(\operatorname{PDiv}(\mathcal O_L)^G\\). \\(\blacksquare\\)

> **Lemma 5.**
Let \\(L/K\\) be a Galois extension of number fields with Galois group \\(G\\).
>    - The group \\(\mathrm H^0(G;\operatorname{Div}(\mathcal O_L))\\) is free abelian generated by \\(\mathfrak p^{1/e_{\mathfrak p}}\\)s. Here, \\(\mathfrak p\\) is a prime ideal of \\(\mathcal O_K\\), and \\(\mathfrak p^{1/e_{\mathfrak p}}\\) is the unique ideal in \\(\mathcal O_L\\) whose \\(e_{\mathfrak p}\\)th power is \\(\mathfrak p\\).
>    - The group \\(\mathrm H^1(G;\operatorname{Div}(\mathcal O_L))\\) is trivial.

*Proof.*
Both calculations will come from using unique prime factorization of ideals to simplify \\(\operatorname{Div}(\mathcal O_L)\\). In particular, as an abelian group, we know that \\(\operatorname{Div}(\mathcal O_L)\\) is generated by the prime ideals. To recover the Galois action, we note that \\(G\\) acts transitively on the collection of primes \\(S_{\mathfrak p}\\) of primes above any given prime \\(\mathfrak p\\) of \\(K\\). Thus,
\\[\operatorname{Div}(\mathcal O_L)=\bigoplus_{\mathfrak p}\mathbb Z[S_{\mathfrak p}].\\]
Letting \\(D_{\mathfrak p}\\) be the stabilizer of some prime above \\(\mathfrak p\\) (which is well-defined up to conjugation), we see that we have an isomorphism
\\[\operatorname{Div}(\mathcal O_L)\cong\bigoplus_{\mathfrak p}\mathbb Z[G/D_{\mathfrak p}].\\]
of \\(\mathbb Z[G]\\)-modules. We now handle each part separately.
- To compute the \\(G\\)-invariants, we see that the \\(G\\)-invariants of \\(\mathbb Z[G/D_{\mathfrak p}]\\) simply look like \\(\sum_{gD_{\mathfrak p}\in G/D_{\mathfrak p}}a_{gD_{\mathfrak p}}(gD_{\mathfrak p})\\) with all coefficients equal. Thus, this is isomorphic to \\(\mathbb Z\\) generated by \\(\sum_{gD_{\mathfrak p}\in G/D_{\mathfrak p}}(gD_{\mathfrak p})\\). Unwinding the isomorphism, we see that this generator corresponds to the ideal in \\(\operatorname{Div}(\mathcal O_L)\\) which is the product of all the primes above \\(\mathfrak p\\), which is the desired statement.
- To compute higher cohomology, note \\(\mathbb Z[G/D_{\mathfrak p}]=\mathbb Z[G]\otimes_{\mathbb Z[D_{\mathfrak p}]}\mathbb Z\\), so Shapiro's lemma informs us that
\\[\mathrm H^i(G;\operatorname{Div}(\mathcal O_L))=\bigoplus_{\mathfrak p}\mathrm H^i(D_{\mathfrak p};\mathbb Z).\\]
For \\(i=1\\), the summands are \\(\mathrm{Hom}(D_{\mathfrak p},\mathbb Z)\\), which is trivial. \\(\blacksquare\\)

> **Proposition 6.**
Let \\(L/K\\) be a Galois extension of number fields with Galois group \\(G\\). Then there is an exact sequence
\\[0\to\mathrm H^1(G;\mathcal O_L^\times)\to\frac{\operatorname{Div}(\mathcal O_L)^G}{\operatorname{PDiv}(\mathcal O_K)}\to\operatorname{Pic}(\mathcal O_L)^G\to\mathrm H^2(G;\mathcal O_L^\times)\to\mathrm H^2(G;L^\times).\\]

*Proof.*
There is a short exact sequence
\\[0\to\operatorname{PDiv}(\mathcal O_L)\to\operatorname{Div}(\mathcal O_L)\to\operatorname{Pic}(\mathcal O_L)\to0.\\]
Taking group cohomology gives
\\[0\to\operatorname{PDiv}(\mathcal O_L)^G\to\operatorname{Div}(\mathcal O_L)^G\to\operatorname{Pic}(\mathcal O_L)^G\to\mathrm H^1(G;\operatorname{PDiv}(\mathcal O_L))\to0,\\]
where the last \\(0\\) follows from Lemma 4. We now fix this exact sequence.
- By Lemma 3, we may replace the ending surjection of this exact sequence with
\\[\operatorname{Pic}(\mathcal O_L)^G\to\mathrm H^2(G;\mathcal O_L^\times)\to\mathrm H^2(G;L^\times).\\]
- Because \\(\operatorname{PDiv}(\mathcal O_K)\\) vanishes in \\(\operatorname{Pic}(\mathcal O_L)\\), we may replace the start of the exact sequence with
\\[0\to\frac{\operatorname{PDiv}(\mathcal O_L)^G}{\operatorname{PDiv}(\mathcal O_K)}\to\frac{\operatorname{Div}(\mathcal O_L)^G}{\operatorname{PDiv}(\mathcal O_K)}\to\operatorname{Pic}(\mathcal O_L)^G.\\]
The result now follows Lemma 3. \\(\blacksquare\\)

The moral is that we have managed to compute \\(\operatorname{Pic}(\mathcal O_L)^G\\) in terms of the cohomology of \\(\mathcal O_L^\times\\) and \\(L^\times\\). Let's apply this to the case of an imaginary quadratic field, proving Theorem 1.

> **Lemma 7.**
Let \\(K\\) be an imaginary quadratic extension of \\(\mathbb Q\\) with Galois group \\(G\\).
>    - The group \\(\mathrm H^1(G;\mathcal O_K^\times)\\) has two elements.
>    - The map \\(\mathrm H^2(G;\mathcal O_K^\times)\to\mathrm H^2(G;K^\times)\\) is injective.

*Proof.*
Because \\(G\\) is cyclic, we may let \\(\sigma\in G\\) be a generator. Recall that the cohomology of any \\(G\\)-module \\(M\\) is given by
\\[\mathrm H^i(G;M)=\begin{cases}
\ker{\operatorname N_G}|_M/(\sigma-1)M & \text{if }i\text{ is odd}, \\\\{}
M^G/\operatorname N_G(M) & \text{if }i\text{ is even}.
\end{cases}\\]
for \\(i>0\\); further, these isomorphisms are functorial in \\(M\\).
- For the first claim, we note the kernel of the norm on \\(\mathcal O_K^\times\\) is all of \\(\mathcal O_K^\times\\): all units are roots of unity, and applying complex conjugation yields the inverse of a root of unity. It follows that \\(\sigma\\) acts by \\(-1\\) on \\(\mathcal O_K^\times\\), so the quotient
\\[\mathrm H^1(G;\mathcal O_K^\times)=\frac{\mathcal O_K^\times}{(\sigma-1)\mathcal O_K^\times}\\]
is just \\(\mathcal O_K^\times/\mathcal O_K^{\times2}\\). Because \\(\mathcal O_K^\times\\) is cyclic (after all, it is a group of roots of unity), it follows that the quotient has size \\(2\\).
- For the second claim, we would like to show that the map
\\[\frac{\mathbb Z^\times}{\operatorname N_{K/\mathbb Q}(\mathcal O_K^\times)}\to\frac{\mathbb Q^\times}{\operatorname{N}_{K/\mathbb Q}(K^\times)}\\]
is injective. Well, the left-hand side is just \\(\\{\pm1\\}\\), so this amounts to nothing that \\(-1\\) is not the image of a norm because norms from imaginary quadratic fields are positive. \\(\blacksquare\\)

*Proof of Theorem 1.*
Let the Galois group of the extension \\(K/\mathbb Q\\) be \\(G\\). By plugging in the results of Lemmas 3 and 7 into the exact sequence of Proposition 6, we get a short exact sequence
\\[0\to\mathbb F_2\to\frac{\operatorname{Div}(\mathcal O_K)^G}{\operatorname{PDiv}(\mathbb Q)}\to\operatorname{Pic}(\mathcal O_K)[2]\to0.\\]
The middle quotient was computed in Lemma 5, which tells us that it is free abelien generated by \\((p)^{1/e_p}\\) for each rational \\(p\\) lying under a prime in \\(S\\). Of course, \\((p)^{1/e_p}\\) is the unique prime in \\(S\\) lying over \\((p)\\), so we see that the middle quotient is the free vector space over \\(\mathbb F_2\\) spanned by \\(S\\). Both claims now follow from the exact sequence. \\(\blacksquare\\)

> **Remark 7.**
There is an analogous statement as Theorem 1 for real quadratic fields, but it is slightly more complicated. (However, I suspect that Remark 2 does not generalize.) For example, the map
\\[\mathrm H^2(G;\mathcal O_K^\times)\to\mathrm H^2(G;K^\times)\\]
does not have to be injective, so \\(\operatorname{Pic}(\mathcal O_K)[2]\\) need not be generated by the ramified primes. Luckily, the discrepancy is not too significant because \\(\mathrm H^2(G;\mathcal O_K^\times)\\) has size at most \\(2\\).