---
title: "The Quadratic Class Number Formula"
date: 2025-11-09
author_profile: false
permalink: /posts/2025/11/quadratic-class-number/
tags:
  - number theory
---

We work out some examples of the class number formula for imaginary quadratic fields.

> **Theorem 1** (Quadratic class number formula)**.**
Let \\(K=\mathbb Q(\sqrt d)\\) be an imaginary quadratic extension of \\(\mathbb Q\\), and let \\(N\\) be the absolute value of the discriminant. If \\(d\notin\\{-1,-3\\}\\), then the class number equals
\\[\frac1{2-\left(\frac d2\right)}\left|\sum_{1\le k\lt N/2}\left(\frac dk\right)\right|.\\]

A similar statement holds for \\(d\in\\{-1,-3\\}\\); see Examples 19 and 20.

> **Remark 2.**
Here, \\(\left(\frac d{\cdot}\right)\\) is the Kronecker symbol. All we need to define is to know that it is multiplicative in the denominator and agrees with the Legendre symbol for odd primes. Then, if \\(N\\) is even, then \\(\left(\frac d2\right)=0\\); otherwise if \\(N\\) is odd so that \\(d\equiv1\pmod4\\), then \\(\left(\frac d2\right)=+1\\) if and only if \\(d\equiv1\pmod8\\).

> **Example 3.**
The class number of \\(\mathbb Q(\sqrt{-2})\\) is
\\[\frac1{2-0}\left|\left(\frac{-2}1\right)+\left(\frac{-2}3\right)\right|=1.\\]

> **Example 4.**
The class number of \\(\mathbb Q(\sqrt{-5})\\) is
\\[\frac1{2-0}\left|\left(\frac{-5}1\right)+\left(\frac{-5}3\right)+\left(\frac{-5}7\right)+\left(\frac{-5}9\right)\right|=2.\\]

> **Example 5.**
The class number of \\(\mathbb Q(\sqrt{-7})\\) is
\\[\frac1{2-1}\left|\left(\frac{-7}1\right)+\left(\frac{-7}2\right)+\left(\frac{-7}3\right)\right|=1.\\]

Let's begin with the general formulation of the class number formula.

> **Definition 6.**
Let \\(K\\) be a number field. Then we define the *Dedekind \\(\zeta\\)-function* to be
\\[\zeta_K(s)=\sum_{I\subseteq\mathcal O_K}\frac1{\operatorname N(I)^s}.\\]
Here, the sum ranges over all ideals \\(I\\) of \\(\mathcal O_K\\), and \\(\operatorname N(I)=[\mathcal O_K:I]\\) is the norm.

> **Remark 7.**
In the region of absolute convergence, the unique prime factorization of ideals gives us the Euler product
\\[\zeta_K(s)=\prod_{\text{prime }\mathfrak p}\frac1{1-\operatorname N(\mathfrak p)^{-s}}.\\]

> **Remark 8.**
Note that each rational prime \\(p\\) admits at most \\([K:\mathbb Q]\\) primes above it, whose norm is bounded below by \\(p\\), so we see that any \\(s\\) with \\(\operatorname{Re}s>1\\) has
\\[\left|\zeta_K(s)\right|\le\prod_{\text{prime }p}\left(\frac1{1-p^{-\operatorname{Re}s}}\right)^{[K:\mathbb Q]}=\zeta(\operatorname{Re}s)^n.\\]
Roughly speaking, it follows that \\(\zeta_K\\) converges absolutely and uniformly on compacts for in the region where \\(\operatorname{Re}s>1\\).

> **Theorem 9** (Class number formula)**.**
Fix a number field \\(K\\). Then \\(\zeta_K(s)\\) admits an analytic continuation to a neighborhood around \\(s=1\\), and it has a simple pole at \\(s=1\\) with residue
\\[\frac{2^{r_1}\cdot(2\pi)^{r_2}\cdot\mathrm{Reg}_K\cdot h_K}{w_K\cdot\sqrt{\left|\operatorname{disc}K\right|}}\\]
Here, \\(r_1\\) and \\(r_2\\) are the numbers of real and complex embeddings, respectively; \\(\mathrm{Reg}_K\\) is the regulator; \\(h_K\\) is the class number; \\(w_K\\) is the number of roots of unity; and \\(\operatorname{disc}K\\) is the discriminant.

*Proof.*
Omitted. This is a fairly difficult theorem! \\(\blacksquare\\)

Most of the quantities listed are typically covered in an algebraic number theory course, but we go ahead and recall the definition of the regulator.

> **Definition 10.**
Fix a number field \\(K\\), and let \\(\\{\rho_1,\ldots,\rho_{r_1}\\}\\) be the real embeddings, and let \\(\\{\sigma_1,\ldots,\sigma_{r_2}\\}\\) be the complex embeddings (up to complex conjugation). Then we choose generators \\(\\{u_1,\ldots,u_{r_1+r_2-1}\\}\\) and construct the matrix
\\[\begin{bmatrix}
\log\left|\rho_1u_1\right| & \cdots & \log\left|\rho_1u_{r_1+r_2-1}\right| \\\\\\\\
\vdots & \ddots & \vdots \\\\\\\\
\log\left|\rho_{r_1}u_1\right| & \cdots & \log\left|\rho_{r_1}u_{r_1+r_2-1}\right| \\\\\\\\
2\log\left|\sigma_1u_1\right| & \cdots & 2\log\left|\sigma_1u_{r_1+r_2-1}\right| \\\\\\\\
\vdots & \ddots & \vdots \\\\\\\\
2\log\left|\sigma_{r_2}u_1\right| & \cdots & 2\log\left|\sigma_{r_2}u_{r_1+r_2-1}\right|
\end{bmatrix}.\\]
Then the *regulator* is the absolute value of the determinant of any \\((r_1+r_2-1)\times(r_1+r_2-1)\\) minor of this \\((r_1+r_2)\times(r_1+r_2-1)\\) matrix.

> **Example 11.**
If \\(K\\) is imaginary quadratic, then the regulator is just \\(1\\) because \\(r_1+r_2-1=0+1-1=0\\).

We are interested in explicating Theorem 9 when \\(K\\) is an imaginary quadratic field. Many of the terms in the conclusion simplify.

> **Lemma 12.**
Fix an imaginary quadratic field \\(K\\), and let \\(N\\) be the absolute value of the discriminant. Then
\\[\frac{2^{r_1}\cdot(2\pi)^{r_2}\cdot\mathrm{Reg}_K\cdot h_K}{w_K\cdot\sqrt{\left|\operatorname{disc}K\right|}}=\frac{\pi h_K}{\overline w_K\sqrt{N}},\\]
where
\\[\overline w_K=\begin{cases}2 & \text{if }d=-1, \\\\3 & \text{if }d=-3, \\\\1 & \text{otherwise}.\end{cases}\\]

*Proof.*
To start, we see that
\\[\frac{2^{r_1}\cdot(2\pi)^{r_2}\cdot\mathrm{Reg}_K\cdot h_K}{w_K\cdot\sqrt{\left|\operatorname{disc}K\right|}}=\frac{2^0\cdot(2\pi)\cdot1\cdot h_K}{w_K\sqrt{N}}.\\]
Now, we claim that
\\[w_K\stackrel?=\begin{cases}4 & \text{if }d=-1, \\\\6 & \text{if }d=-3, \\\\2 & \text{otherwise}.\end{cases}\\]
This claims completes the proof after a simplification.

It remains to show the claim. Well, because \\(\varphi(m)>2\\) for any \\(m>6\\), we see that \\(\zeta_m\\) can live in a quadratic field only when \\(m\in\\{1,2,3,4,6\\}\\). The \\(2\\) at the bottom is thanks to \\(m\in\\{1,2\\}\\), and the remaining cases come from \\(m=4\\) and \\(m\in\\{3,6\\}\\), respectively. \\(\blacksquare\\)

It remains to figure out to compute the residue of \\(\zeta_K(s)\\) at \\(s=1\\). In light of the Euler product expansion of \\(\zeta_K(s)\\), this amounts to understanding how primes split in \\(K\\). There are plenty of elementary descriptions of this written, so we give a somewhat non-elementary presentation.

> **Lemma 13.**
Fix a quadratic extension \\(K\\) of \\(\mathbb Q\\), and let \\(p\\) be a rational prime. Then we have the following splitting behavior.
>   - Ramifies: if \\(p\mid\operatorname{disc}K\\), then \\(p\mathcal O_K=\mathfrak p^2\\).
>   - Splits: if \\(p\nmid\operatorname{disc}K\\) and \\(\mathrm{Frob}_p\\) fixes \\(K\\), then \\(p\mathcal O_K=\mathfrak p_1\mathfrak p_2\\).
>   - Inert: if \\(p\nmid\operatorname{disc}K\\) and \\(\mathrm{Frob}_p\\) acts nontrivially on \\(K\\), then \\(p\mathcal O_K\\) is prime.

*Proof.*
We quickly handle ramification: if \\(p\mid\operatorname{disc}K\\), then the ramification index of \\(p\\) is more than \\(1\\), so given factorization is forced by the fundamental identity.

Otherwise, we have that \\(p\\) is unramified so that \\(K\\) embeds into \\(\mathbb Q_p^{\mathrm{unr}}\\). By the fundamental identity, we either have that \\(p\mathcal O_K\\) splits or is inert. Now, \\(\mathrm{Frob}_p\\) is the topological generator of \\(\operatorname{Gal}(\mathbb Q_p^{\mathrm{unr}}/\mathbb Q_p)\\), so \\(\mathrm{Frob}_p\\) acts nontrivially on \\(K\\) if and only if \\(K\not\subseteq\mathbb Q_p\\). This means that \\(K\otimes\mathbb Q_p\\) will be a field, so \\(p\\) is inert. On the other hand, trivial action means \\(K\subseteq\mathbb Q_p\\), so the primes in \\(K\\) above \\(p\\) have degree \\(1\\), meaning that we are split. \\(\blacksquare\\)

This result can be neatly encoded into the quadratic Dirichlet character attached to \\(K\\). Recall that the Kroneckerâ€“Weber theorem tells us that \\(\mathbb Q^{\mathrm{ab}}\\) is a union of cyclotomic fields, so \\(\operatorname{Gal}(\mathbb Q^{\mathrm{ab}}/\mathbb Q)\\) is isomorphic to \\(\widehat{\mathbb Z}^\times\\).

> **Definition 14.**
Fix a quadratic extension \\(K\\) of \\(\mathbb Q\\). Then we define the *quadratic Dirichlet character* \\(\chi_K\\) to be the composite
\\[\widehat{\mathbb Z}^\times\cong\operatorname{Gal}(\mathbb Q^{\mathrm{ab}}/\mathbb Q)\twoheadrightarrow\operatorname{Gal}(K/\mathbb Q)\cong\\{\pm1\\}.\\]

> **Remark 15.**
In [this post](/posts/2025/11/quadratic-dirichlet/), we showed that \\(\chi_K\\) factors as an odd primitive Dirichlet character\\(\pmod N\\), where \\(N=\left|\operatorname{disc}K\right|\\). There we also showed that \\(\chi_K(p)=+1\\) if and only if \\(\mathrm{Frob}_p\\) acts trivially on \\(K\\); in short, this holds because the leftmost canonical isomorhism sends \\(p\in\widehat{\mathbb Z}^\times\\) to \\(\mathrm{Frob}_p\in\operatorname{Gal}(\mathbb Q^{\mathrm{ab}}/\mathbb Q)\\). It follows that \\(\chi_K\\) is the Jacobi symbol mentioned in Remark 2.

> **Proposition 16.**
Fix a quadratic extension \\(K\\) of \\(\mathbb Q\\). Then
\\[\zeta_K(s)=\zeta(s)L(s,\chi_K).\\]
Here, the Dirichlet \\(L\\)-function \\(L(s,\chi_K)\\) is viewing \\(\chi_K\\) as a primitive Dirichlet character\\(\pmod N\\), where \\(N=\left|\operatorname{disc}K\right|\\).

*Proof.*
By analytic continuation, it is enough to check this in the region of absolute convergence, which we do by comparing Euler products. As such, it is enough to fix a rational prime \\(p\\) and check that
\\[\prod_{\mathfrak p\mid p\mathcal O_K}\frac1{1-\operatorname N(\mathfrak p)^{-s}}\stackrel?=\frac1{1-p^{-s}}\cdot\frac1{1-\chi(p)p^{-s}},\\]
or
\\[\prod_{\mathfrak p\mid p\mathcal O_K}\left(1-\operatorname N(\mathfrak p)^{-s}\right)\stackrel?=\left(1-p^{-s}\right)\left(1-\chi(p)p^{-s}\right).\\]
We do this in cases.
- Ramified: if \\(p\mid\operatorname{disc}K\\), then \\(p=\mathfrak p^2\\), so the equality reads \\(\left(1-p^{-s}\right)=\left(1-p^{-s}\right)\\). (Here, \\(\chi(p)=0\\) by convention.)
- Splits: if \\(p\nmid\operatorname{disc}K\\) and \\(\mathrm{Frob}_p\\) acts trivially on \\(K\\), then \\(p\mathcal O_K=\mathfrak p_1\mathfrak p_2\\) and \\(\chi_K(p)=+1\\), so the equality reads \\(\left(1-p^{-s}\right)^2=\left(1-p^{-s}\right)\left(1-p^{-s}\right)\\).
- Inert: if \\(p\nmid\operatorname{disc}K\\) and \\(\mathrm{Frob}_p\\) acts onontrivially on \\(K\\), then \\(p\mathcal O_K\\) is prime and \\(\chi_K(p)=-1\\), so the equality reads \\(\left(1-p^{-2s}\right)=\left(1-p^{-s}\right)\left(1+p^{-s}\right)\\).

The above casework completes the proof. \\(\blacksquare\\)

> **Corollary 17.**
Fix a quadratic extension \\(K\\) of \\(\mathbb Q\\). Then the residue of \\(\zeta_K(s)\\) at \\(s=1\\) is \\(L(1,\chi_K)\\).

*Proof.*
By the statement of the class number formula in Theorem 9 and Proposition 16, it is enough to check that \\(\zeta(s)\\) has a simple pole at \\(s=1\\) with residue \\(1\\). This is a classical result, but let's recall one suggestive argument. Note
\\[\Gamma(s)n^{-s}=\int_{\mathbb R^+}t^se^{-nt}\,\frac{dt}t,\\]
so
\\[\Gamma(s)\zeta(s)=\int_{\mathbb R^+}\Bigg(\sum_{n=1}^\infty e^{-nt}\Bigg)t^s\,\frac{dt}t,\\]
which is
\\[\Gamma(s)\zeta(s)=\int_{\mathbb R^+}\left(\frac{1}{e^t-1}\right)t^s\,\frac{dt}t.\\]
For brevtiy, set \\(g(t)=t/\left(e^t-1\right)\\); note we may extend \\(g\\) continuously to \\(0\\) by \\(g(0)=1\\). Then we may integrate \\(\Gamma(s)\zeta(s)=\int_{\mathbb R^+}g(t)t^{s-2}\,dt\\), so integration by parts gives
\\[\Gamma(s)\zeta(s)=-\frac1{s-1}\int_{\mathbb R^+}g'(t)t^s\,\frac{dt}t.\\]
We now see that \\(g\\) is a perfectly reasonable Schwartz function on \\(\mathbb R_{\ge0}\\), so the integral defines a holomorphic function in the region where \\(\operatorname{Re}s>1\\). At \\(s=1\\), we can evaluate the integral as \\(-g(0)=-1\\), so the residue here is \\(1\\). \\(\blacksquare\\)

It remains to compute \\(L(1,\chi_K)\\). In fact, it is enough to merely compute its magnitude, so we recall the following result.

> **Proposition 18.**
Fix an odd primitive Dirichlet character \\(\chi\pmod N\\). Then
\\[\left|L(1,\chi)\right|=\frac{\pi}{\left|\chi(2)-2\right|\sqrt N}\left|\sum_{1\le k\lt N/2}\chi(k)\right|.\\]

*Proof.*
We refer to [this blog post](/posts/2025/11/dirichlet-special-value-at-1/). \\(\blacksquare\\)

We are now ready to prove Theorem 1.

*Proof of Theorem 1.*
This follows from combining Lemma 12, Corollary 17, and Proposition 18 with Theorem 9. Indeed, Proposition 18 tells us
\\[\frac{\pi}{(2-\chi_K(2))\sqrt N}\left|\sum_{1\le k\lt N/2}\chi_K(k)\right|\\]
equals \\(\left|L(1,\chi_K)\right|\\). Then Corollary 17 tells us that this is the absolute value of the residue of \\(\zeta_K(s)\\) at \\(s=1\\), which is
\\[\frac{\pi h_K}{\overline w_K\sqrt N}\\]
by Theorem 9 and Lemma 12. Comparing the two displayed formulae completes the proof once we acknowledge that \\(\overline w_K=1\\) for \\(d\notin\\{-1,-3\\}\\). \\(\blacksquare\\)

The above argument explains why Theorem 1 must avoid \\(d\in\\{-1,-3\\}\\): in these cases, the presence of extra roots of unity changes requires us to scale down appropriately. Nonetheless, there is still an analogous statement.

> **Example 19.**
For \\(K=\mathbb Q(\sqrt{-1})\\), the proof of Theorem 1 shows that \\(h_K/2\\) equals
\\[\frac1{2-0}\left|\left(\frac{-1}1\right)\right|=\frac12.\\]

> **Example 20.**
For \\(K=\mathbb Q(\sqrt{-3})\\), the proof of Theorem 1 shows that \\(h_K/3\\) equals
\\[\frac1{2+1}\left|\left(\frac{-1}3\right)\right|=\frac13.\\]