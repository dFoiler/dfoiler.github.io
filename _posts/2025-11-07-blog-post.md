---
title: "Quadratic Subfields of Cyclotomic Fields"
date: 2025-11-07
author_profile: false
permalink: /posts/2025/11/quadratic-subfields-cyclotomic/
tags:
  - number theory
  - gauss sums
---

We use Gauss sums to work out the quadratic subfields of cyclotomic fields.

Here is the main character for today.

> **Definition 1.**
Fix a Dirichlet character \\(\chi\pmod p\\) for a prime \\(p\\). Then we define the Gauss sum
\\[\tau(\chi)=\sum_{a\in\mathbb F_p^\times}\chi(a)\zeta_N^a.\\]

> **Proposition 2.**
Fix a prime \\(p\\) and a nontrivial Dirichlet character \\(\chi\pmod p\\). Then \\(\left|\tau(\chi)\right|^2=N\\).

*Proof.*
This is a direct calculation. Observe
\\[\tau(\chi)\overline{\tau(\chi)}=\sum_{a,b\in\mathbb F_p^\times}\chi(a)\overline\chi(b)\zeta_p^{a-b}.\\]
Note \\(\chi(a)\overline\chi(b)=\chi(a/b)\\), so we may re-index the sum as
\\[\sum_{a,b\in\mathbb F_p^\times}\chi(ab)\overline\chi(b)\zeta_p^{ab-b}=\sum_{a,b\in\mathbb F_p^\times}\chi(a)\zeta_p^{(a-1)b}.\\]
We would like to isolate the sum on \\(b\\) so that we get a sum of roots of unity, but this does not exactly work yet because \\(b\\) only varies over \\(\mathbb F_p^\times\\) instead of all \\(\mathbb F_p\\). Well, adding in \\(b=0\\) does nothing because \\(\sum_a\chi(a)=0\\) anyway (recall \\(\chi\\) is nontrivial!), so our sum is actually
\\[\sum_{a\in\mathbb F_p^\times}\Bigg(\chi(a)\sum_{b\in\mathbb Z/N\mathbb Z}\zeta_p^{(a-1)b}\Bigg).\\]
Now, if \\(a\ne1\\), then the inner sum vanishes. Thus, we are left with \\(\chi(1)\cdot N=N\\). \\(\blacksquare\\)

> **Corollary 3.**
For each odd prime \\(p\\), we have
\\[\sqrt{\left(\frac{-1}p\right)p}\in\mathbb Q(\zeta_p).\\]

*Proof.*
Consider the nontrivial character \\(\chi=\left(\frac{\cdot}p\right)\\) on \\(\mathbb F_p^\times\\). Then we know that \\(\tau(\chi)\overline{\tau(\chi)}=p\\) by Proposition 7. However, \\(\chi\\) outputs to real numbers, so
\\[\overline{\tau(\chi)}=\sum_{a\in\mathbb F_p^\times}\chi(a)\zeta_p^{-a}\\]
equals \\(\chi(-1)\tau(\chi)\\) after re-indexing the sum. Thus, \\(\tau(\chi)^2=\left(\frac{-1}p\right)p\\). \\(\blacksquare\\)

> **Notation 4.**
For an odd prime \\(p\\), we define \\(p^*=\left(\frac{-1}p\right)p\\).

> **Remark 5.**
To extend to \\(2\\), we note that \\(\zeta_8+\zeta_8^{-1}=\sqrt2\\).

We can now classify quadratic sub-extensions of \\(\mathbb Q(\zeta_N)\\).

> **Proposition 6.**
Fix a positive integer \\(N\\). Let \\(S\\) denote the set consisting of \\(p^*\\) for each odd prime divisor \\(p\\) of \\(N\\), along with \\(-1\\) if \\(4\mid N\\) and \\(2\\) if \\(8\mid N\\). For a squarefree integer \\(d\\), we have \\(\sqrt d\in\mathbb Q(\zeta_N)\\) if and only if \\(d\\) is a product of elements in \\(S\\).

*Proof.*
In one direction, note that having a square root in \\(\mathbb Q(\zeta_N)\\) is preserved by taking products, so it is enough to show that each element of \\(S\\) has a square root in \\(\mathbb Q(\zeta_N)\\). For odd primes \\(p\\), this is Corollary 8. For \\(2\\), this is Remark 10. Lastly, for \\(-1\\), this is just noting that \\(\zeta_4=i\\).

It remains to show that \\(\mathbb Q(\zeta_N)\\) admits no more square roots, which will do by a counting argument. We will use Galois theory to turn this into a group theory problem. Note that \\(\mathbb Q(\sqrt d)\\) is a distinct quadratic extension of \\(\mathbb Q\\) for each \\(d\\), so we have thus far exhibited \\(2^{\\#S}-1\\) quadratic subextensions of \\(\mathbb Q(\zeta_N)\\). We will show that this is all of them. Well, such extensions are in bijection with index-\\(2\\) subgroups of the Galois group, which are in bijection with nontrivial homomorphisms
\\[\operatorname{Gal}(\mathbb Q(\zeta_N)/\mathbb Q)\to\mathbb Z/2\mathbb Z.\\]
Adding \\(1\\) for the trivial homomorphism and recalling that \\(\operatorname{Gal}(\mathbb Q(\zeta_N)/\mathbb Q)\cong(\mathbb Z/N\mathbb Z)^\times\\), we see that we need to show
\\[\\#\operatorname{Hom}((\mathbb Z/N\mathbb Z)^\times,\mathbb Z/2\mathbb Z)=2^{\\#S}.\\]
This is now a group theory problem. By the Chinese remainder theorem, we may reduce this to counting
\\[\operatorname{Hom}((\mathbb Z/N\mathbb Z)^\times,\mathbb Z/2\mathbb Z)=\prod_{\text{prime }p}\operatorname{Hom}\left(\Big(\mathbb Z/p^{\nu_p(N)}\mathbb Z\Big)^\times,\mathbb Z/2\mathbb Z\right).\\]
Now, for each odd prime \\(p\\) dividing \\(N\\), we know \\((\mathbb Z/p^{\nu_p(N)}\mathbb Z)^\times\\) is cyclic of even size, so we get a factor of \\(2\\). For \\(p=2\\), we note that
\\[(\mathbb Z/2^\nu\mathbb Z)^\times=\begin{cases}
0 & \text{if }4\nmid N, \\\\(\mathbb Z/2\mathbb Z)\times(\mathbb Z/2^{\nu-2}\mathbb Z) & \text{if }4\mid N.
\end{cases}\\]
Thus, we get no additional factors of \\(2\\) if \\(N\\) is odd or not divisible by \\(4\\), and we get one additional factor of \\(2\\) if \\(N\\) is divisible by \\(4\\), and we get another additional factor of \\(2\\) if \\(N\\) is divisible by \\(8\\). These factors of \\(2\\) exactly describe the size of \\(S\\), so we are done. \\(\blacksquare\\)

> **Remark 7.**
It is in fact possible to directly write down a Gauss sum which squares to \\(\pm d\\) for any odd \\(d\\), but it requires using more general Dirichlet characters than we have bothered with.

Because it is not very hard, let's explain how we can use these ideas to prove quadratic reciprocity.

> **Theorem 8** (Quadratic reciprocity)**.**
Fix distinct odd primes \\(p\\) and \\(q\\). Then
\\[\left(\frac pq\right)=\left(\frac{q^*}p\right)\\]

*Proof.*
We will show that either side of the given equation equals \\(1\\) if and only if \\(\mathrm{Frob}_p\\) fixes \\(\sqrt{q^*}\\).
- On one hand, \\(\mathrm{Frob}\_p\\) fixing \\(\sqrt{q^\*}\\) is equivalent to having \\(\mathrm{Frob}\_p\\) fix the quadratic Gauss sum
    \\[\tau=\sum_{a\in\mathbb F_q^\times}\left(\frac aq\right)\zeta_q^a.\\]
    However, \\(\mathrm{Frob}_p\colon\zeta_q\mapsto\zeta_q^p\\), so a quick reindexing shows that \\(\mathrm{Frob}_p(\tau)=\left(\frac pq\right)\tau\\).
    
    Alternatively, one can use Galois theory for this point: \\(\mathrm{Frob}_p\\) needs to be in the unique index-\\(2\\) subgroup of \\((\mathbb Z/q\mathbb Z)^\times\\), which consist of the squares.

- On the other hand, \\(\mathrm{Frob}_p\\) fixes \\(\sqrt{q^\*}\\) if and only if \\(\mathbb Q(\sqrt{q^\*})\\) is fixed by \\(\mathrm{Frob}_p\\) once embedded in \\(\mathbb Q_p^{\mathrm{unr}}\\). Because \\(\mathrm{Frob}_p\\) is a topological generator of \\(\operatorname{Gal}(\mathbb Q_p^{\mathrm{unr}}/\mathbb Q_p)\\), this is equivalent to \\(\mathbb Q(\sqrt{q^\*})\subseteq\mathbb Q_p\\), which is equivalent to having \\(\sqrt{q^\*}\in\mathbb Q_p\\). By Hensel's lemma, this is equivalent to \\(\left(\frac{q^\*}p\right)=1\\).

Combining the above two points completes the proof. \\(\blacksquare\\)

<!-- We work out some basic facts about quadratic Dirichlet characters from the perspective of Galois theory.

Recall that the Kronecker–Weber theorem shows that
\\[\mathbb Q^{\mathrm{ab}}=\bigcup\_{N\ge1}\mathbb Q(\zeta_N).\\]
Thus, there is a canonical isomorphism
\\[\widehat{\mathbb Z}^\times\to\operatorname{Gal}(\mathbb Q^{\mathrm{ab}})/\mathbb Q)=\operatorname{Gal}(\overline{\mathbb Q}/\mathbb Q)^{\mathrm{ab}}.\\]
In the sequel, we will denote this isomorphism by \\(\operatorname{Art}_{\mathbb Q}\\). This allows us to make the following definition.

> **Definition 1.**
Fix a quadratic extension \\(K\\) of \\(\mathbb Q\\). Then we define the *quadratic character \\(\chi_K\\)* of \\(K\\) to be the composite
\\[\widehat{\mathbb Z}^\times\cong\operatorname{Gal}(\overline{\mathbb Q}/\mathbb Q)^{\mathrm{ab}}\twoheadrightarrow\operatorname{Gal}(K/\mathbb Q)\cong\\{\pm1\\}\subseteq\mathbb C^\times.\\]
If \\(K=\mathbb Q(\sqrt d)\\), we may abbreviate \\(\chi_K\\) to \\(\chi_d\\).

> **Remark 2.**
It is a bit dishonest to use the Kronecker–Weber theorem to define these characters. Technically, one only needs to know that the quadratic field \\(K\\) is contained in a cyclotomic field, which we will show shortly directly in Proposition 13.

We are interested in proving some basic facts on these characters. Here is the kind of calculation we want to do.

> **Example 3.**
Fix a quadratic extension \\(K\\) of \\(\mathbb Q\\). Then we claim that
\\[\chi_K(-1)\stackrel?=\begin{cases}+1 & \text{if }K\text{ is real}, \\\\ -1 & \text{if }K\text{ is imaginary}.\end{cases}\\]
To start, note \\(-1\in\widehat{\mathbb Z}^\times\\) goes to the automorphism \\(\operatorname{Art}\_{\mathbb Q}(-1)\\) which sends \\(\zeta\\) to \\(\zeta^{-1}\\) for each root of unity \\(\zeta\\). But \\(\overline\zeta=\zeta^{-1}\\), so we see that \\(\operatorname{Art}\_{\mathbb Q}(-1)\\) is complex conjugation. It follows that \\(\chi_K(-1)=+1\\) if and only if complex conjugation acts trivially on \\(K\\), so the result follows.

If we squint, we can make the above example also work for "finite places," but we will work this out in a more elementary way shortly.

> **Example 4.**
Fix a quadratic extension \\(K\\) of \\(\mathbb Q\\), and let \\(p\\) be a rational prime unramified in \\(K\\). Then we claim
\\[\chi_K(p)\stackrel?=\begin{cases}+1 & \text{if }K\subseteq\mathbb Q_p, \\\\ -1 & \text{if }K\not\subseteq\mathbb Q_p.\end{cases}\\]
Indeed, note that \\(\operatorname{Art}_{\mathbb Q}(p)\\) is acting by the \\(p\\)th power on a generating set of \\(\mathbb Q^{\mathrm{ab}}\\), so it is the Frobenius \\(\mathrm{Frob}_p\\). Accordingly, we embed \\(K\hookrightarrow\mathbb Q_p^{\mathrm{unr}}\\), and we see that \\(\mathrm{Frob}_p\\) extends (uniquely) to the usual Frobenius in \\(\operatorname{Gal}(\mathbb Q_p^{\mathrm{unr}}/\mathbb Q_p)\\), which is a topological generator. We conclude that \\(\mathrm{Frob}_p\\) acts trivially on \\(K\\) if and only if \\(K\subseteq\mathbb Q_p\\).

> **Remark 5.**
If we write \\(K=\mathbb Q(\sqrt d)\\), then the preceding example shows that
\\[\chi_K(p)\stackrel?=\left(\frac dp\right)\\]
for any prime \\(p\\) unramified in \\(K\\). Indeed, \\(K\subseteq\mathbb Q_p\\) if and only if \\(\sqrt d\in\mathbb Q_p\\). Because \\(p\\) does not divide \\(d\\), this is equivalent to having \\(\sqrt d\in\mathbb Z_p\\). By Hensel's lemma (noting that \\(p\\) is odd for now), this is equivalent to \\(\sqrt d\in\mathbb F_p\\), which is equivalent to \\(\left(\frac dp\right)=+1\\).

We now attempt to compute the conductor of \\(\chi_K\\). By the nature of the canonical isomorphism \\(\widehat{\mathbb Z}^\times\cong\operatorname{Gal}(\mathbb Q^{\mathrm{ab}}/\mathbb Q)\\), this means that we need to find the smallest \\(N\\) for which \\(K\subseteq\mathbb Q(\zeta_N)\\). The most direct way to do this is via quadratic Gauss sums, building up from primes.

> **Corollary 12.**
Let \\(d\\) be a squarefree integer, and set \\(K=\mathbb Q(\sqrt d)\\). Then the conductor of \\(\chi_K\\) is the absolute value of the discriminant of \\(d\\). In other words, the conductor is
\\[\begin{cases}\left|d\right| & \text{if }d\equiv1\pmod4, \\\\ 4\left|d\right| & \text{otherwise}.\end{cases}\\]

*Proof.*
Let \\(N\\) be the conductor, which by definition means that \\(\mathbb Q(\zeta_N)\\) is the smallest cyclotomic field containing \\(K\\). By Proposition 11, we see that \\(\mathbb Q(\zeta_N)\\) containing \\(\sqrt d\\) means that each prime dividing \\(d\\) also divides \\(N\\), so we at least have \\(d\mid N\\). On the other hand, we see that \\(\mathbb Q(\zeta_{4d})\\) has square roots of all the prime factors of \\(d\\) (even \\(2\\)) as well as \\(\sqrt{-1}\\), so certainly \\(N\le4d\\).

We now have the following cases.
- If \\(d\\) is even, then Proposition 11 tells us that we must also have \\(8\mid N\\). It follows that \\(N\ge4d\\), so equality follows.
- If \\(d\equiv1\pmod4\\), then we see
    \\[d=\prod_{p\mid d}p^*.\\]
    Indeed, this certainly holds up to sign by unique prime factorization, and we have the correct sign by checking\\(\pmod4\\). It follows that \\(N\le d\\), so equality follows.
- If \\(d\equiv3\pmod4\\), then the previous point shows that \\(\sqrt{-d}\in\mathbb Q(\zeta_d)\\). Thus, because \\(\sqrt{-1}\notin\mathbb Q(\zeta_d)\\), we are forced to have \\(4\mid N\\) and so \\(N\ge4d\\), so equality follows.

The above cases complete the proof. \\(\blacksquare\\)

> **Example 13.**
Let's give a different argument for Example 4 and Remark 5. To compute \\(\chi_d(p)\\), we want to show that \\(\mathrm{Frob}\_p\\) fixes \\(\sqrt d\\) if and only if \\(\left(\frac dp\right)=1\\). Well, for a given odd prime \\(q\\) (distinct from a prime \\(p\\)), we see that \\(\mathrm{Frob}\_p\\) fixes \\(\sqrt{q^\*}\\) if and only if \\(\mathrm{Frob}\_p\\) fixes the unique quadratix subextension of \\(\mathbb Q(\zeta_q)\\), which is equivalent to \\(p\\) living in the squares of \\((\mathbb Z/q\mathbb Z)^\times\\). By quadratic reciprocity, this is equivalent to \\(\left(\frac{q^*}p\right)=1\\). Thus, the claim holds if \\(d\\) is a \\(q^\*\\), and extending multiplicatively shows that the claim holds whenever \\(d\equiv1\pmod4\\). Lastly, one can check the claim for \\(d\in\\{-1,2\\}\\) by hand (using \\(\sqrt{-1}=\zeta_4\\) and \\(\sqrt{2}=\zeta_8+\zeta_8^{-1}\\)), so we are done! -->

<!-- > **Remark 14.**
One can avoid the "extending multiplicatively" step if one has a way to write \\(\sqrt d\\) directly as a Gauss sum. This is indeed possible, but it is mildly more technical. -->

<!-- > **Remark 14.**
Isolating the use of quadratic reciprocity in Example 13 actually shows that we can compare the calculations of Remark 5 and Example 13 to prove quadratic reciprocity. Indeed, this is essentially the standard proof using algebraic number theory. -->

<!-- > **Definition 6.**
Fix a multiplicative character \\(\chi\colon(\mathbb Z/N\mathbb Z)^\times\to\mathbb C^\times\\) and an additive character \\(\psi\colon(\mathbb Z/N\mathbb Z)\to\mathbb C^\times\\). Then we define the Gauss sum
\\[\tau(\chi;\psi)=\sum_{a\in(\mathbb Z/N\mathbb Z)^\times}\chi(a)\psi(a).\\]

> **Remark 7.**
Let's quickly classify additive characters to relate this to the usual definition. A homomorphism \\(\psi\colon(\mathbb Z/N\mathbb Z)\to\mathbb C^\times\\) is uniquely determined by \\(\psi(1)\\), which must be some \\(N\\)th root of unity \\(\zeta_N^a\\) for some \\(a\\). Thus, we may write each additive character \\(\psi\\) as \\(\psi_a\colon k\mapsto\zeta_N^{ak}\\) for some \\(a\\).

> **Remark 8.**
Many additive characters \\(\psi_a\\) have uninteresting Gauss sums. In particular, if \\(d=\gcd(a,N)\\) is bigger than \\(1\\), and \\(\chi\\) is primitive, then we claim that \\(\tau(\chi;\psi_a)=0\\). Well, \\(\psi_a\\) factors through \\(\mathbb Z/(N/d)\mathbb Z\\), but \\(\chi\\) does not, so the sum should vanish. More formally, choose some \\(b\\) which is \\(b\equiv1\pmod{N/d}\\) and \\(\chi(b)\ne1\\). Then
\\[\sum_{c\in(\mathbb Z/N\mathbb Z)^\times}\chi(c)\psi_a(c)=\sum_{c\in(\mathbb Z/N\mathbb Z)^\times}\chi(c)\psi_a(bc)=\chi(b)^{-1}\sum_{c\in(\mathbb Z/N\mathbb Z)^\times}\chi(c)\psi_a(c),\\]
so the sum vanishes.

Remark 8 notably leaves out the important case where \\(\gcd(a,N)=1\\), which is handled by the following lemma.

> **Proposition 9.**
Fix a primitive Dirichlet character \\(\chi\pmod N\\) . Then \\(\left|\tau(\chi;\psi_1)\right|^2=N\\).

*Proof.*
This is a direct calculation. Observe
\\[\tau(\chi)\overline{\tau(\chi)}=\sum_{a,b\in(\mathbb Z/N\mathbb Z)^\times}\chi(a)\overline\chi(b)\zeta_N^{a-b}.\\]
Note \\(\chi(a)\overline\chi(b)=\chi(a/b)\\), so we may re-index the sum as
\\[\sum_{a,b\in(\mathbb Z/N\mathbb Z)^\times}\chi(ab)\overline\chi(b)\zeta_N^{ab-b}=\sum_{a,b\in(\mathbb Z/N\mathbb Z)^\times}\chi(a)\zeta_N^{(a-1)b}.\\]
We would like to isolate the sum on \\(b\\) so that we get a sum of roots of unity, but this does not exactly work yet because \\(b\\) only varies over \\((\mathbb Z/N\mathbb Z)^\times\\). Well, for each \\(b\notin(\mathbb Z/N\mathbb Z)^\times\\), we see that the term
\\[\sum_{a\in(\mathbb Z/N\mathbb Z)^\times}\chi(a)\zeta_N^{(a-1)b}=\zeta_N^{-b}\tau(\chi;\psi_b)\\]
vanishes by Remark 8. (Here is where we use that \\(\chi\\) is primitive!) Thus, our sum is actually
\\[\sum_{a\in(\mathbb Z/N\mathbb Z)^\times}\Bigg(\chi(a)\sum_{b\in\mathbb Z/N\mathbb Z}\zeta_N^{(a-1)b}\Bigg).\\]
Now, if \\(a\ne1\\), then the inner sum vanishes. Thus, we are left with \\(\chi(1)\cdot N=N\\). \\(\blacksquare\\)

> **Corollary 10.**
Fix a primitive Dirichlet character \\(\chi\pmod N\\).

For convenience, we extend \\(\chi\\) to \\(\mathbb Z/N\mathbb Z\\) by declaring \\(\chi(k)=0\\) if \\(k\notin(\mathbb Z/N\mathbb Z)^\times\\).  -->